!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("echarts/lib/chart/map"),require("echarts/lib/echarts"),require("echarts/lib/component/tooltip"),require("echarts/lib/component/legend")):"function"==typeof define&&define.amd?define(["exports","echarts/lib/chart/map","echarts/lib/echarts","echarts/lib/component/tooltip","echarts/lib/component/legend"],t):t((e=e||self).eMap={},null,e.echarts)}(this,function(e,t,c){"use strict";function i(i,n){var o=null;return function(){var e=this,t=arguments;clearTimeout(o),o=setTimeout(function(){i.apply(e,t)},n)}}function a(e){return Object.prototype.toString.call(e)}function h(e){return"[object Object]"===a(e)}function p(e){return"[object Array]"===a(e)}c=c&&c.hasOwnProperty("default")?c.default:c;var n={categoryAxis:{axisLine:{show:!1},axisTick:{show:!1},splitLine:{show:!1}},valueAxis:{axisLine:{show:!1}},line:{smooth:!0},grid:{containLabel:!0,left:10,right:10}},s=["#19d4ae","#5ab1ef","#fa6e86","#ffb980","#0067a6","#c4b4e4","#d87a80","#9cbbff","#d9d0c7","#87a997","#d49ea2","#5b4947","#7ba3a8"],d=["grid","dataZoom","visualMap","toolbox","title","legend","xAxis","yAxis","radar","tooltip","axisPointer","brush","geo","timeline","graphic","series","backgroundColor","textStyle"];function f(t,i){Object.keys(i).forEach(function(e){i[e]&&(t[e]=i[e])})}function o(e){this.data=e.data,this.settings=e.settings||{},this.width=e.width,this.height=e.height,this.el=e.el||"bar",this.beforeConfig=e.beforeConfig,this.afterConfig=e.afterConfig,this.afterSetOption=e.afterSetOption,this.afterSetOptionOnce=e.afterSetOptionOnce,this.events=e.events,this.grid=e.grid,this.colors=e.colors,this.tooltipVisible=e.tooltipVisible||!0,this.legendVisible=e.legendVisible||!0,this.legendPosition=e.legendPosition,this.markLine=e.markLine,this.markArea=e.markArea,this.markPoint=e.markPoint,this.visualMap=e.visualMap,this.dataZoom=e.dataZoom,this.toolbox=e.toolbox,this.initOptions=e.initOptions,this.title=e.title,this.legend=e.legend,this.xAxis=e.xAxis,this.yAxis=e.yAxis,this.radar=e.radar,this.tooltip=e.tooltip,this.axisPointer=e.axisPointer,this.brush=e.brush,this.geo=e.geo,this.timeline=e.timeline,this.graphic=e.graphic,this.series=e.series,this.backgroundColor=e.backgroundColor,this.textStyle=e.textStyle,this.animation=e.animation,this.theme=e.theme,this.themeName=e.themeName,this.loading=e.loading,this.dataEmpty=e.dataEmpty,this.extend=e.extend,this.judgeWidth=e.judgeWidth||!1,this.widthChangeDelay=e.widthChangeDelay||300,this.tooltipFormatter=e.tooltipFormatter||function(){},this.resizeable=e.resizeable||!0,this.resizeDelay=e.resizeDelay||200,this.changeDelay=e.changeDelay||0,this.setOptionOpts=e.setOptionOpts||!0,this.cancelResizeCheck=e.cancelResizeCheck,this.notSetUnchange=e.notSetUnchange,this.log=e.log||!0,this.created(),this.init()}function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}o.prototype.chartHandler=null,o.prototype.dataHandler=function(){if(this.chartHandler){var e=this.data,t=e.columns,i=void 0===t?[]:t,n=e.rows,o=void 0===n?[]:n,r={tooltipVisible:this.tooltipVisible,legendVisible:this.legendVisible,echarts:this.echarts,color:s,tooltipFormatter:this.tooltipFormatter,_once:this._once},a=this.chartHandler(i,o,this.settings,r);a&&("function"==typeof a.then?a.then(this.optionsHandler.bind(this)):this.optionsHandler(a))}},o.prototype.init=function(){var e=this;if(!this.echarts){var t=this.themeName||this.theme||n;this.echarts=c.init(document.getElementById(this.el),t,this.initOptions),this.data&&this.changeHandler(),this.createEventProxy(),this.resizeable&&window.addEventListener("resize",i(function(){e.resize()},1e3))}},o.prototype.addResizeListener=function(){window.addEventListener("resize",this.resizeHandler),this._once.onresize=!0},o.prototype.removeResizeListener=function(){window.removeEventListener("resize",this.resizeHandler),this._once.onresize=!1},o.prototype.created=function(){this.echarts=null,this.registeredEvents=[],this._once={},this._store={},this.resizeHandler=i.call(this,this.resize,this.resizeDelay),this.changeHandler=i(this.dataHandler,this.changeDelay)},o.prototype.createEventProxy=function(){var t=this,o=this,e=Object.keys(this.events||{});e.length&&e.forEach(function(e){var n;-1===t.registeredEvents.indexOf(e)&&(t.registeredEvents.push(e),t.echarts.on(e,(n=e,function(){if(n in o.events){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];o.events[n].apply(null,t)}})))})},o.prototype.optionsHandler=function(t){var i,n,o,e,r=this;if(this.legendPosition&&t.legend&&(t.legend[this.legendPosition]=10,~["left","right"].indexOf(this.legendPosition)&&(t.legend.top="middle",t.legend.orient="vertical")),t.color=this.chartColor(),d.forEach(function(e){r[e]&&(t[e]=r[e])}),this.animation&&(i=t,n=this.animation,Object.keys(n).forEach(function(e){i[e]=n[e]})),this.markArea||this.markLine||this.markPoint){var a={markArea:this.markArea,markLine:this.markLine,markPoint:this.markPoint},s=t.series;p(s)?s.forEach(function(e){f(e,a)}):h(s)&&f(s,a)}this.extend&&(o=t,e=this.extend,Object.keys(e).forEach(function(i){var n=e[i];~i.indexOf(".")?function(e,t,i){if(t){var n=e,o=t.split(".");o.forEach(function(e,t){t===o.length-1?n[e]=i:(n[e]||(n[e]={}),n=n[e])})}}(o,i,n):"function"==typeof n?o[i]=n(o[i]):p(o[i])&&h(o[i][0])?o[i].forEach(function(e,t){o[i][t]=Object.assign({},e,n)}):h(o[i])?o[i]=Object.assign({},o[i],n):o[i]=n}));var l=this.setOptionOpts;!this.settings.bmap&&!this.settings.amap||h(l)||(l=!1),this._isDestroyed||(this.log&&console.log(t),this.echarts.setOption(t,l))},o.prototype.resize=function(){this.cancelResizeCheck?this.echartsResize():this.el&&this.echartsResize()},o.prototype.chartColor=function(){return this.colors||s},o.prototype.echartsResize=function(){this.echarts&&this.echarts.resize()};var v={th:3,mi:6,bi:9,tr:12},l={zeroFormat:null,nullFormat:null,defaultFormat:"0,0",scalePercentBy100:!0,abbrLabel:{th:"k",mi:"m",bi:"b",tr:"t"}},y=1e12,x=1e9,O=1e6,k=1e3;function z(e,t,i,n){var o=e.toString().split("."),r=t-(n||0),a=2===o.length?Math.min(Math.max(o[1].length,r),t):r,s=Math.pow(10,a),l=(i(e+"e+"+a)/s).toFixed(a);if(t-a<n){var c=new RegExp("\\.?0{1,"+(n-(t-a))+"}$");l=l.replace(c,"")}return l}function u(e,t,i,n){var o=Math.abs(t),r=!1,a=!1,s="",l="",c=!1,h=void 0,p=void 0;t=t||0,~(i=i||"").indexOf("(")?(r=!0,i=i.replace(/[(|)]/g,"")):(~i.indexOf("+")||~i.indexOf("-"))&&(p=~i.indexOf("+")?i.indexOf("+"):t<0?i.indexOf("-"):-1,i=i.replace(/[+|-]/g,"")),~i.indexOf("a")&&(h=!!(h=i.match(/a(k|m|b|t)?/))&&h[1],~i.indexOf(" a")&&(s=" "),i=i.replace(new RegExp(s+"a[kmbt]?"),""),y<=o&&!h||"t"===h?(s+=e.abbrLabel.tr,t/=y):o<y&&x<=o&&!h||"b"===h?(s+=e.abbrLabel.bi,t/=x):o<x&&O<=o&&!h||"m"===h?(s+=e.abbrLabel.mi,t/=O):(o<O&&k<=o&&!h||"k"===h)&&(s+=e.abbrLabel.th,t/=k)),~i.indexOf("[.]")&&(a=!0,i=i.replace("[.]","."));var d=t.toString().split(".")[0],f=i.split(".")[1],u=i.indexOf(","),m=(i.split(".")[0].split(",")[0].match(/0/g)||[]).length;if(f?(d=(l=~f.indexOf("[")?z(t,(f=(f=f.replace("]","")).split("["))[0].length+f[1].length,n,f[1].length):z(t,f.length,n)).split(".")[0],l=~l.indexOf(".")?"."+l.split(".")[1]:"",a&&0==+l.slice(1)&&(l="")):d=z(t,0,n),s&&!h&&1e3<=+d&&s!==v.trillion&&(d=""+ +d/1e3,s=v.million),~d.indexOf("-")&&(d=d.slice(1),c=!0),d.length<m)for(var g=m-d.length;0<g;g--)d="0"+d;-1<u&&(d=d.toString().replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1,")),i.indexOf(".")||(d="");var b=d+l+(s||"");return r?b=(r&&c?"(":"")+b+(r&&c?")":""):0<=p?b=0===p?(c?"-":"+")+b:b+(c?"-":"+"):c&&(b="-"+b),b}function m(t,i){Object.keys(i).forEach(function(e){t[e]=i[e]})}var g={},b={};function S(e,t,i){var n;return function(e,t,i){t=t||g.defaultFormat,i=i||Math.round;var n=void 0,o=void 0;if(0===e&&null!==g.zeroFormat)n=g.zeroFormat;else if(null===e&&null!==g.nullFormat)n=g.nullFormat;else{for(var r in b)if(b[r]&&t.match(b[r].regexp)){o=b[r].format;break}n=(o=o||u.bind(null,g))(e,t,i,S)}return n}(0===e||void 0===e?0:null===e||"number"==typeof(n=e)&&isNaN(n)?null:"string"==typeof e?g.zeroFormat&&e===g.zeroFormat?0:g.nullFormat&&e===g.nullFormat||!e.replace(/[^0-9]+/g,"").length?null:+e:+e||null,t,i)}m(g,l),S.options=g,S._numberToFormat=u.bind(null,g),S.register=function(e,t){b[e]=t},S.unregister=function(e){b[e]=null},S.setOptions=function(e){m(g,e)},S.reset=function(){m(g,l)},S.register("percentage",{regexp:/%/,format:function(e,t,i,n){var o=~t.indexOf(" %")?" ":"",r=void 0;return n.options.scalePercentBy100&&(e*=100),t=t.replace(/\s?%/,""),r=~(r=n._numberToFormat(e,t,i)).indexOf(")")?((r=r.split("")).splice(-1,0,o+"%"),r.join("")):r+o+"%"}});var ke=function(e,t,i){var n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:"-";if(isNaN(e))return n;if(!t)return e;if("[object Function]"===a(t))return t(e,S);i=isNaN(i)?0:++i;var o=".[".concat(new Array(i).join(0),"]"),r=t;switch(t){case"KMB":r=i?"0,0".concat(o,"a"):"0,0a";break;case"normal":r=i?"0,0".concat(o):"0,0";break;case"percent":r=i?"0,0".concat(o,"%"):"0,0.[00]%"}return S(e,r)},E={},ze=function(e){var n,t=e.position,i=e.positionJsonLink,o=e.beforeRegisterMapOnce,r=e.mapURLProfix,a=i||"".concat(r).concat(t,".json");return E[a]||(E[a]=(n=a,new Promise(function(e,t){var i=new XMLHttpRequest;i.open("GET",n),i.send(null),i.onload=function(){e(JSON.parse(i.responseText))},i.onerror=function(){t(JSON.parse(i.responseText))}})).then(function(e){return o&&(e=o(e)),e})),E[a]};function Se(e,t,i){"object"===r(e)?t[i]=e:e&&(t[i]={normal:{show:!0},emphasis:{show:!0}})}function Ee(e,t){var i=e._once,n=e.registerSign,o=e.beforeRegisterMap,r=e.beforeRegisterMapOnce,a=e.registerSignOnce,s=e.position,l=e.specialAreas;i[n]||(o&&(t=o(t)),r&&!i[a]&&(i[a]=!0,t=r(t)),i[n]=!0,c.registerMap(s,t,l))}o.prototype.chartHandler=function(e,t,i,n){var o=i.position,r=void 0===o?"china":o,a=i.selectData,s=void 0!==a&&a,l=i.selectedMode,c=i.label,h=void 0===c||c,p=i.dataType,d=void 0===p?{}:p,f=i.digit,u=void 0===f?2:f,m=i.dimension,g=void 0===m?e[0]:m,b=i.roam,v=i.center,y=i.aspectScale,x=i.boundingCoords,O=i.zoom,k=i.scaleLimit,z=i.legendName,S=void 0===z?{}:z,E=i.labelMap,M=void 0===E?{}:E,L=i.mapGrid,w=i.itemStyle,R=i.positionJsonLink,j=i.beforeRegisterMap,P=i.beforeRegisterMapOnce,A=i.mapURLProfix,F=void 0===A?"https://unpkg.com/echarts@3.6.2/map/json/":A,C=i.specialAreas,_=void 0===C?{}:C,H=i.mapOrigin,N=e.slice();i.metrics?N=i.metrics:N.splice(e.indexOf(g),1);var D=n.tooltipVisible,T=n.legendVisible,V=n.color,G=n._once,q={};t.forEach(function(e){q[e[g]]=e});var J,U,B,I,Z,W,$,K,X,Q,Y,ee,te,ie,ne,oe,re,ae,se,le,ce,he,pe,de,fe,ue,me,ge,be,ve=D&&(J=d,U=u,B=q,I=N,Z=V,W=M,{formatter:function(o){var r=[];return o.name?(r.push("".concat(o.name,"<br>")),I.forEach(function(e,t){var i,n=null!=W[e]?W[e]:e;r.push("".concat((i=Z[t],['<span style="',"background-color:".concat(i,";"),"display: inline-block;","width: 10px;","height: 10px;","border-radius: 50%;","margin-right:2px;",'"></span>'].join(""))," ").concat(n," : ")),B[o.name]?r.push(ke(B[o.name][e],J[e],U)):r.push("-"),r.push("<br>")}),r.join(" ")):""}}),ye=T&&(K=($={metrics:N,legendName:S,labelMap:M}).metrics,X=$.legendName,Q=$.labelMap,X||Q?{data:Q?K.map(function(e){return null==Q[e]?e:Q[e]}):K,formatter:function(e){return null!=X[e]?X[e]:e}}:{data:K}),xe=(ee=(Y={position:r,selectData:s,label:h,itemStyle:w,dimension:g,metrics:N,rows:t,selectedMode:l,roam:b,center:v,aspectScale:y,boundingCoords:x,zoom:O,labelMap:M,scaleLimit:k,mapGrid:L}).position,te=Y.selectData,ie=Y.dimension,ne=Y.metrics,oe=Y.rows,re=Y.label,ae=Y.itemStyle,se=Y.selectedMode,le=Y.roam,ce=Y.center,he=Y.aspectScale,pe=Y.boundingCoords,de=Y.zoom,fe=Y.labelMap,ue=Y.scaleLimit,me=Y.mapGrid,ge=[],be={type:"map",mapType:ee},ne.forEach(function(t){var i=Object.assign({name:null!=fe[t]?fe[t]:t,data:[],selectedMode:se,roam:le,center:ce,aspectScale:he,boundingCoords:pe,zoom:de,scaleLimit:ue},be);me&&Object.keys(me).forEach(function(e){i[e]=me[e]}),Se(ae,i,"itemStyle"),Se(re,i,"label"),oe.forEach(function(e){i.data.push({name:e[ie],value:e[t],selected:te})}),ge.push(i)}),ge),Oe={_once:G,beforeRegisterMap:j,beforeRegisterMapOnce:P,registerSign:"MAP_REGISTER_".concat(r),registerSignOnce:"ONCE_MAP_REGISTER_".concat(r),position:r,specialAreas:_};return H?(Ee(Oe,H),{series:xe,tooltip:ve,legend:ye}):ze({position:r,positionJsonLink:R,beforeRegisterMapOnce:P,mapURLProfix:F}).then(function(e){return Ee(Oe,e),{series:xe,tooltip:ve,legend:ye}})},e.eMap=o,Object.defineProperty(e,"__esModule",{value:!0})});
